<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>lisp-ish.js</title>
    <script src="./build/bundle.js"></script>
</head>
<body>
    <div id="console"></div>
    <script>
    var consoleElement = document.getElementById('console');
    function consoleLog(s){
        consoleElement.innerText += s + '\n';
    }
    </script>
    <script>

(function(){

    function filter(L, fn){
        if (cdr(L) === null){
            if (fn(car(L))){
                return cons(car(L), null);
            } else {
                return null;
            }
        } else {
            if (fn(car(L))){
                return cons(car(L), filter(cdr(L), fn));
            } else {
                return filter(cdr(L), fn);
            }
        }
    }
    function map(L, fn){
        if (cdr(L) === null){
            return cons(fn(car(L)), null);
        } else {
            return cons(fn(car(L)), map(cdr(L), fn));
        }
    }
    function reduce(L, fn, acc){
        function reduceHelper(L, fn, acc){
            if (cdr(L) === null){
                return fn(car(L), acc);
            } else {
                return reduce(cdr(L), fn, fn(car(L), acc));
            }
        }
        if (typeof separator === 'undefined'){
            return reduceHelper(L, fn, 0);
        } else {
            return reduceHelper(L, fn, acc);
        }
    }
    function peek(L){
        if (cdr(L) === null){
            return car(L);
        } else {
            return peek(cdr(L));
        }
    }
    function push(L, val){
        if (cdr(L) === null){
            return cons(car(L), cons(val, null));
        } else {
            return cons(car(L), push(cdr(L), val));
        }
    }
    function pop(L){
        // Returns a cons with the new linkedList
        // in the car position, and the popped value in
        // the cdr position
        function popHelper(L){
            if (cdr(L) === null){
                return null;
            } else {
                return cons(car(L), popHelper(cdr(L)));
            }
        }
        return cons(popHelper(L), peek(L));
    }
    function enqueue (L, val) {
        return cons(val, L);
    }
    function dequeue (L) {
        // Returns a cons with the new linkedList
        // in the car position, and the dequeued value in
        // the cdr position
        return cons(cdr(L), car(L));
    }

    var linkedList = cons(1, null);
    linkedList = push(linkedList, 2);
    linkedList = push(linkedList, 3);
    linkedList = push(linkedList, 4);
    linkedList = push(linkedList, 5);
    linkedList = push(linkedList, 6);
    consoleLog(print(linkedList, '.', '', ''));
    var mapped = map(linkedList, function(n){
        return n * 2;
    });
    var filtered = filter(linkedList, function(n){
        return n % 2 === 0;
    });
    var badFilter = filter(linkedList, function(n){
        return false;
    });
    var reduceAdd = reduce(linkedList, function(a, b){
        return a + b;
    }, 0);
    var reduceMul = reduce(linkedList, function(a, b){
        return a * b;
    }, 1);
    consoleLog(print(mapped, '.', '', ''));
    consoleLog(print(filtered, '.', '', ''));
    consoleLog(reduceAdd);
    consoleLog(reduceMul);
    var tree = cons(cons(cons(1, null), cons(2, null)), cons(2, cons(3, cons(4, cons(5, cons(6, null))))));
    consoleLog(print(tree));



    function curry(fn){
        var args = [];
        var len = fn.length;
        function helper(){
            args.push.apply(args, arguments);
            return helper;
        }
        helper.prototype.valueOf = function(){
            return fn.apply(this, args);
        };
        helper.valueOf = function(){
            return fn.apply(this, args);
        };
        return helper;
    }
    function add(){
        var total = 0;
        for (var i = 0; i < arguments.length; i++){
            total += arguments[i];
        } 
        return total;
    }
    var cur = curry(add);
    var cur2 = curry(add);
    consoleLog(cur(1)(2)(3)(4)(5)(6));
    var foo = cur2(1)(2)(3)(4)(5)(6);
    consoleLog('');
    consoleLog(foo);


    consoleLog('')
    consoleLog('')
    consoleLog(print(linkedList));
    consoleLog(print(linkedList.cdr));
    consoleLog(print(linkedList.cddr));
    consoleLog(print(linkedList.cdddr));


})();



    </script>
</body>
</html>